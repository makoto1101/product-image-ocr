/* --- Google Fontsの読み込み --- */
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap');

/* --- 全体のスタイル --- */
body {
    font-family: 'Noto Sans JP', sans-serif;
    color: #333;
}

/* --- メインコンテンツエリアの調整 --- */
.main .block-container {
    padding-top: 3rem;
}

/* --- サイドバーのスタイル --- */
.st-emotion-cache-16txtl3 {
    background-color: #f8f9fa;
    padding: 1.5rem;
}

.st-emotion-cache-16txtl3 h1,
.st-emotion-cache-16txtl3 h2,
.st-emotion-cache-16txtl3 h3 {
    color: #0d6efd;
}

/* --- カードデザイン --- */
.st-emotion-cache-16txtl3 .st-emotion-cache-1r4qj8v {
    background-color: #ffffff;
    border: 1px solid #dee2e6;
    border-radius: 12px;
    padding: 1.2rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
}

/* --- ボタンの立体デザイン (デフォルト: 青) --- */
.stButton > button {
    border: none;
    border-radius: 8px;
    padding: 5px 10px;
    font-weight: 700;
    color: white;
    background: linear-gradient(145deg, #5c87c9, #1c3457);
    box-shadow: 4px 4px 10px #cccccc, -4px -4px 10px #ffffff;
    transition: all 0.2s ease-in-out;
}

/* --- プライマリボタン (緑) --- */
.stButton > button.st-emotion-cache-19rxjzo {
    background: linear-gradient(145deg, #198754, #146c43);
}

.stButton > button:hover {
    opacity: 0.9;
    box-shadow: 2px 2px 5px #bbbbbb, -2px -2px 5px #ffffff;
}

/* デフォルトボタン (青) の active */
.stButton > button:active {
    box-shadow: inset 4px 4px 8px #19355e, inset -4px -4px 8px #2c609c;
}

/* プライマリボタン (緑) の active */
.stButton > button.st-emotion-cache-19rxjzo:active {
    background: linear-gradient(145deg, #146c43, #198754);
    box-shadow: inset 4px 4px 8px #105535, inset -4px -4px 8px #22b973;
}

.stButton > button:disabled {
    background: #e9ecef;
    color: #adb5bd;
    border: 1px solid #ced4da;
    box-shadow: none;
}

/* --- テキスト入力欄 --- */
.stTextInput input {
    border-radius: 8px;
    border: 1px solid #ced4da;
    padding: 10px;
    transition: border-color 0.2s, box-shadow 0.2s;
}

.stTextInput input:focus {
    border-color: #86b7fe;
    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
}

/* --- サイドバーの幅を広げる --- */
[data-testid="stSidebar"] {
    width: 550px !important;
}

/* --- キャンセルボタン（グレー）--- */
[data-testid="stSidebar"] div[data-testid="stHorizontalBlock"] > div:nth-child(2) .stButton > button {
    background: linear-gradient(145deg, #868e96, #6c757d);
    box-shadow: 4px 4px 10px #cccccc, -4px -4px 10px #ffffff;
}

[data-testid="stSidebar"] div[data-testid="stHorizontalBlock"] > div:nth-child(2) .stButton > button:active {
    box-shadow: inset 4px 4px 8px #5a6268, inset -4px -4px 8px #9098a0;
}

/* --- プログレスバーのスタイル --- */
[data-testid="stProgressBar"] > div > div {
    background-color: #28a745 !important; /* 緑色 */
    height: 10px !important;
    border-radius: 5px !important;
}

/* 念のため、一つ少ない階層も指定 */
[data-testid="stProgressBar"] > div {
    /* background-color: #f0f2f6;  */ /* 外側のバーの色はデフォルトのままにする */
    border-radius: 5px !important; /* 角丸だけ適用 */
}

/* --- [修正] Excelダウンロードボタンのスタイル (青) --- */
a.download-button-excel {
    display: inline-block; /* st.button のような振る舞いにする */
    width: 100%; /* コンテナ幅いっぱいに広げる */
    box-sizing: border-box; /* paddingを含めてwidth 100%にするため */

    border: none !important;
    border-radius: 8px !important;
    /* [変更] 上下のpaddingを小さくし、ログアウトボタンの高さに合わせる */
    padding: 8px 6px !important;
    font-weight: 400 !important; /* 700 -> 400 */
    color: white !important;
    text-decoration: none !important; /* リンクの下線を消す */
    text-align: center; /* 文字を中央揃えに */

    /* 青系の背景と影に変更 */
    background: linear-gradient(145deg, #5c87c9, #1c3457) !important;
    box-shadow: 4px 4px 10px #cccccc, -4px -4px 10px #ffffff !important;
    transition: all 0.2s ease-in-out !important;
}

a.download-button-excel:hover {
    opacity: 0.9 !important;
    box-shadow: 2px 2px 5px #bbbbbb, -2px -2px 5px #ffffff !important;
    color: white !important; /* ホバー時も文字色を白に固定 */
    text-decoration: none !important; /* リンクの下線を消す */
}

a.download-button-excel:active {
    /* active時のスタイルも青系に合わせる */
    box-shadow: inset 4px 4px 8px #19355e, inset -4px -4px 8px #2c609c !important;
    color: white !important; /* 念のため */
    text-decoration: none !important; /* リンクの下線を消す */
}

/* --- ★テーブルコンテナと固定ヘッダー用のスタイル --- */
.table-container {
    max-height: 75vh;
    overflow: auto;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    border: 1px solid #dee2e6;
}

/* テーブル自体の設定 */
.custom_df {
    width: max-content;         /* 中身に合わせて幅を確保 */
    min-width: 100%;
    border-collapse: separate;  /* stickyヘッダー用 */
    border-spacing: 0;
}

/* --- 1. 全セルの基本設定（自動調整ベース） --- */
.custom_df th, .custom_df td {
    padding: 8px 10px;          /* 余白を少し詰める */
    text-align: left;
    border-bottom: 1px solid #c2c2c2;
    border-right: 1px solid #c2c2c2;
    font-size: 16px;
    vertical-align: middle;     /* 縦方向中央揃え */
    
    /* ★基本は小さめにして、内容に応じて広がるようにする */
    min-width: 110px;           /* 最小幅を小さくリセット */
    max-width: 400px;           /* テキストが長すぎる場合は折り返す */
    
    white-space: normal;        /* 折り返し許可 */
    word-break: break-word;
}

/* 左端の枠線 */
.custom_df th:first-child, .custom_df td:first-child {
    border-left: 1px solid #dee2e6;
}

/* --- 2. 列ごとの個別調整 --- */

/* 1列目：No（固定幅・狭く） */
.custom_df th:nth-child(1), .custom_df td:nth-child(1) {
    width: 1% !important;        /* 内容に合わせて極限まで縮める設定 */
    min-width: 30px !important;  /* ただし最低30pxは確保 */
    max-width: 50px !important;  /* どんなに広くても50pxまで */
    white-space: nowrap;         /* "No" の文字を折り返さない */
    padding: 8px 4px !important; /* 左右の余白を狭くする */
    text-align: center;
}

/* 2列目：画像名 */
.custom_df th:nth-child(2), .custom_df td:nth-child(2) {
    min-width: 200px;
    max-width: 300px;
}

/* ★ここを修正しました★
   ステータス列がなくなったため、列番号が1つずつ前にずれています。
   それに合わせて計算式を修正しました。
   
   [現在の並び順] 
   1:No, 2:画像名, 3:画像1, 4:OCR1, 5:内容量1, 6:画像2...
*/

/* --- 画像列の設定 (3, 6, 9列目...) --- */
.custom_df td:nth-child(3n) {
    padding: 0 !important;      /* 余白を消す */
    min-width: 100px;           /* 画像列の幅確保 */
    min-height: 300px;           /* 画像列の幅確保 */
}

/* --- OCR列の設定 (4, 7, 10列目...) --- */
.custom_df th:nth-child(3n+1), .custom_df td:nth-child(3n+1) {
    min-width: 200px;           /* テキスト用に広さを確保 */
    max-width: auto;           /* 長すぎる場合は折り返し */
    white-space: normal;        /* 自動調整（折り返し）を有効に */
}

/* --- 内容量列の設定 (5, 8, 11列目...) --- */
.custom_df th:nth-child(3n+2), .custom_df td:nth-child(3n+2) {
    min-width: 100px;           /* 短いテキスト用に調整 */
    max-width: auto;           /* 長すぎる場合は折り返し */
    white-space: normal;
}

/* --- 画像自体の設定（ここは変更していません） --- */
.custom_df td img {
    display: block;             /* 隙間を消す */
    width: 100%;                /* セル幅いっぱいに広げる */
    min-width: 250px;           /* 画像自体の最小幅も確保 */
    min-height: 250px;          /* auto ではなく、具体的な高さを指定して高さを確保 */
    object-fit: cover;
}

/* ホバーエフェクト */
.custom_df tbody tr:hover {
    background-color: #f1f3f5;
}
.custom_df tbody tr:hover td:hover {
    background-color: #e9ecef;
}

/* リンク設定 */
.custom_df a {
    text-decoration: none;
    color: inherit;
    display: block;
    width: 100%;
    height: 100%;
}

/* ヘッダー固定の再確認 */
.custom_df th {
    position: sticky;
    top: 0;
    z-index: 2;
    background-color: #f8f9fa;
    border-top: 1px solid #dee2e6;
    border-bottom: 2px solid #b9bec2;
}

.custom_df tbody tr:hover td:hover {
    background-color: #e9ecef;
}

.image-mode-only .custom_df td img {
    object-fit: contain !important;  /* 無理やり伸ばさず、全体を収める */
    height: auto !important;         /* アスペクト比を維持 */
    max-height: 300px !important;    /* 巨大になりすぎないよう上限を設定 */
    background-color: transparent !important; /* 背景を透明にする */
}

/* --- 1列目 (No) の固定設定 --- */
.custom_df th:nth-child(1),
.custom_df td:nth-child(1) {
    position: sticky;
    left: 0;
    z-index: 1;                  /* 通常セルより手前に表示 */
    width: 50px !important;      /* 2列目の位置を合わせるため幅を固定 */
    min-width: 50px !important;  
    max-width: 50px !important;  
    background-color: #ffffff;   /* 横スクロール時にデータが透けないように白背景を指定 */
}

/* --- 2列目 (画像名) の固定設定 --- */
.custom_df th:nth-child(2),
.custom_df td:nth-child(2) {
    position: sticky;
    left: 50px;                  /* 1列目の幅(50px)分だけ右にずらして配置 */
    z-index: 1;
    background-color: #ffffff;   /* 透け防止 */
    border-right: 2px solid #dee2e6; /* 固定エリアの区切りを明確にする縦線 */
}

/* --- 固定列のヘッダー背景色 (左上エリア) --- */
/* 「上固定」かつ「左固定」のエリアなので z-index を最強(3)にする必要があります */
.custom_df th:nth-child(1),
.custom_df th:nth-child(2) {
    z-index: 3; 
    background-color: #f8f9fa;   /* ヘッダーと同じグレー背景にする */
}

/* --- チェックボックスのスタイル --- */
/* チェックが入った時の背景色と枠線の色を青に設定 */
div[data-testid="stCheckbox"] > label > div[data-baseweb="checkbox"] > div[aria-checked="true"] {
    background-color: #0d6efd !important;
    border-color: #0d6efd !important;
}
/* チェック前の枠線の色を青に設定 */
div[data-testid="stCheckbox"] > label > div[data-baseweb="checkbox"] > div {
    border-color: #0d6efd !important;
}

/* --- マルチセレクトの選択済みアイテム --- */
/* 選択されたアイテム（タグ）の背景色を青に設定 */
div[data-baseweb="tag"] {
    background-color: #0d6efd !important;
}
/* タグ内のテキスト色を白に設定 */
div[data-baseweb="tag"] span {
    color: white !important;
}
/* タグ内の削除ボタン(x)のアイコン色を白に設定 */
div[data-baseweb="tag"] [aria-label="Remove item"] {
    color: white !important;
}

/* --- メインコンテンツのコンテナ（フィルターエリアなど） --- */
[data-testid="stVerticalBlockBorderWrapper"] {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

/* --- トーストの背景色（緑）と位置（右下） --- */
[data-testid="stToast"] {
    background-color: #8de6a2; 
    color: #000000; 
    
    /* ▼▼▼ 以下4行を追加 ▼▼▼ */
    top: auto !important;     /* 上の位置指定を解除 */
    bottom: 2rem !important;  /* 下から 2rem (約32px) の位置に指定 */
    right: 2rem !important;   /* 右から 2rem (約32px) の位置に指定 */
    left: auto !important;    /* 左の位置指定を解除 */
}

/* トースト内の閉じるボタン（X）も白にする */
[data-testid="stToast"] button {
    color: white;
}

/* --- ログアウトボタン（グレー）--- */
/* key="logout_button" に対応 */
[data-testid="stButton-logout_button"] {
    background: linear-gradient(145deg, #868e96, #6c757d) !important;
    color: white !important;
    box-shadow: 4px 4px 10px #cccccc, -4px -4px 10px #ffffff !important;
    border: none !important;
}

[data-testid="stButton-logout_button"]:hover {
    background: linear-gradient(145deg, #868e96, #6c757d) !important;
    opacity: 0.9 !important;
    box-shadow: 2px 2px 5px #bbbbbb, -2px -2px 5px #ffffff !important;
    color: white !important;
}

[data-testid="stButton-logout_button"]:active {
    background: linear-gradient(145deg, #868e96, #6c757d) !important;
    box-shadow: inset 4px 4px 8px #5a6268, inset -4px -4px 8px #9098a0 !important;
}

/* --- ページネーションボタン（グレー）--- */
/* key="page_first", "page_prev", "page_next", "page_last" に対応 */
[data-testid="stButton-page_first"],
[data-testid="stButton-page_prev"],
[data-testid="stButton-page_next"],
[data-testid="stButton-page_last"] {
    background: linear-gradient(145deg, #868e96, #6c757d) !important;
    color: white !important;
    box-shadow: 4px 4px 10px #cccccc, -4px -4px 10px #ffffff !important;
    border: none !important;
}

[data-testid="stButton-page_first"]:hover,
[data-testid="stButton-page_prev"]:hover,
[data-testid="stButton-page_next"]:hover,
[data-testid="stButton-page_last"]:hover {
    background: linear-gradient(145deg, #868e96, #6c757d) !important;
    opacity: 0.9 !important;
    box-shadow: 2px 2px 5px #bbbbbb, -2px -2px 5px #ffffff !important;
    color: white !important;
}

[data-testid="stButton-page_first"]:active,
[data-testid="stButton-page_prev"]:active,
[data-testid="stButton-page_next"]:active,
[data-testid="stButton-page_last"]:active {
    background: linear-gradient(145deg, #868e96, #6c757d) !important;
    box-shadow: inset 4px 4px 8px #5a6268, inset -4px -4px 8px #9098a0 !important;
}

/* --- ページネーションボタン（非アクティブ時）--- */
/* :disabled 状態（リクエスト通り、薄いグレー） */
[data-testid="stButton-page_first"]:disabled,
[data-testid="stButton-page_prev"]:disabled,
[data-testid="stButton-page_next"]:disabled,
[data-testid="stButton-page_last"]:disabled {
    /* Streamlitのデフォルトグレーボタンに戻す */
    background: #e9ecef !important;
    color: #adb5bd !important;
    border: 1px solid #ced4da !important;
    box-shadow: none !important;
}

/* Streamlitのメインコンテナの上部余白を強制的に減らす */
div.block-container {
    padding-top: 2.5rem;
}


/* --- Excel保存ボタン (緑) --- */
[data-testid="stDownloadButton-download_excel_button"] > button {
    background: linear-gradient(145deg, #5adb9f, #146c43) !important;
    color: white !important;
    box-shadow: 4px 4px 10px #cccccc, -4px -4px 10px #ffffff !important;
    border: none !important;
    
    /* st.download_button は高さ調整の padding-top/bottom が必要 */
    padding-top: 8px !important;
    padding-bottom: 8px !important;
    font-weight: 400 !important;
}

[data-testid="stDownloadButton-download_excel_button"] > button:hover {
    background: linear-gradient(145deg, #5adb9f, #146c43) !important;
    opacity: 0.9 !important;
    box-shadow: 2px 2px 5px #bbbbbb, -2px -2px 5px #ffffff !important;
    color: white !important;
}

[data-testid="stDownloadButton-download_excel_button"] > button:active {
    background: linear-gradient(145deg, #5adb9f, #146c43) !important;
    box-shadow: inset 4px 4px 8px #105535, inset -4px -4px 8px #22b973 !important;
}